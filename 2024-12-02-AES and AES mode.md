# AES 標準實作與 AES 模式研究

---

## 摘要

AES（Advanced Encryption Standard）是現代加密技術中最為廣泛使用的對稱加密演算法。本次報告旨在學習 AES 的標準結構與數學基礎，以程式實作 NIST FIPS 147。此外，本次報告實現了 AES 標準和多種操作模式（NIST SP 800-38 系列），並對不同模式進行程式實作以更貼近實際應用情境。本次報告的重點還包括提供可變參數的 AES 程式實作，允許自定義參數（如 MixColumns 向量和 S-Box），以支援後續專案需求。

以下是各章節的內容簡述：

1. **AES 標準實作(NIST FIPS 147)**：說明 AES 的核心結構與實現，包括 SubBytes、ShiftRows、MixColumns 和 AddRoundKey 四個步驟，以及性能優化策略。
2. **AES 模式（NIST SP-800-38 系列）**：實作並分析 NIST SP 800-38 系列模式，包括常見模式（如 ECB、CBC、CTR）與其他模式（如 CMAC、XTS 等）的特性與可能的應用場景。
3. **總結**：回顧三個月以來的程式實作，並討論未來改進方向。
4. **附錄**：提供完整的程式碼實作與測試案例。
5. **未來精進方向**：討論本專題的可能改進方向，包括數學理論加速與軟體程式優化。

---

## 1. AES 標準實作

### 1.1 AES 核心四步驟（4 Steps）

AES 經歷長期考驗，並依據 NIST 認證為具備量子抗性（Quantum-Resistant, QC）的對稱式加密演算法。本報告不深入探討學術上如何防止攻擊，而是著重於了解 AES 的內部運作流程。

AES 的加密過程由以下四個主要步驟組成，每一輪加密均需完成這些操作：

1. **SubBytes**：使用 S-Box 進行非線性替代，將數據映射到新的空間，從而提高數據的混淆性。
2. **ShiftRows**：行位移操作，通過改變數據在行內的位置進一步增加混淆效果。
3. **MixColumns**：列混合操作，通過矩陣運算將數據分散在多個列中，增強密文與明文的關聯性。
4. **AddRoundKey**：將當前數據與對應輪密鑰進行 XOR 運算，進一步加強數據的保護。

---

### 1.2 S-Box 的結構與設計

S-Box 是 AES 核心的非線性替代步驟，其結構是基於有限域 GF(2^8) 上的數學運算構建的。具體特性如下：

- **生成過程**：S-Box 由逆元計算和仿射變換構成，確保輸入與輸出之間的非線性關係。
- **數學特性**：
  - 強化抗線性攻擊與差分攻擊的能力。
  - 保持輸出分佈的均勻性，避免弱點集中。

---

### 1.3 MixColumns 的數學基礎

MixColumns 是 AES 中的擴散步驟，通過對數據進行矩陣運算增強密文的強健性：

- **運算原理**：在有限域 GF(2^8) 上，MixColumns 的核心操作是矩陣乘法，其固定矩陣為：
\[
  M = \begin{bmatrix}
  2 & 3 & 1 & 1 \\
  1 & 2 & 3 & 1 \\
  1 & 1 & 2 & 3 \\
  3 & 1 & 1 & 2
  \end{bmatrix}
\]
  此矩陣保證每列數據會與其他列數據混合，從而提升加密數據的複雜性。
- **特性**：
  - 增強數據間的相依性，避免僅影響部分數據。
  - 在解密過程中，使用逆矩陣恢復原始數據。

---

### 1.4 可行的性能優化與延伸實作

1. **使用費馬小定理**：在計算有限域逆元時，採用費馬小定理（a^{p-1} \equiv 1 \mod p）簡化運算，特別是在生成 S-Box 時提高計算效率。
2. **降解 GF(2^8)**：
   - 簡化多項式運算的模數過程，減少計算複雜度。
   - 使用查表法（Lookup Table）快速完成有限域內的加法和乘法，進一步提升 AES 運算的效率。

---

## 2. AES 模式（Modes of Operation）

### 2.1 NIST SP 800-38 系列模式實作

#### 2.1.1 800-38A
- **電子密碼本模式（ECB）**：結構簡單但安全性較低，適用於小型不敏感數據加密。
- **密碼區塊鏈模式（CBC）**：適合文件加密和數據流，需注意 IV 的安全生成。
- **計數器模式（CTR）**：高效能流加密模式，但需保證計數器唯一性。

#### 2.1.2 800-38B
- **CMAC**：基於 AES 的消息完整性驗證機制，適合網路通信協議。

#### 2.1.3 800-38E
- **XTS**：專為磁碟加密設計，適用於隨機存取數據。

---

### 2.2 其他模式簡介

- **800-38C (GCM)**：結合認證與加密，適用於 HTTPS、VPN。
- **800-38D (AEAD)**：加密與元數據認證。
- **800-38F (FPE)**：格式保持加密，用於支付系統。

---

### 2.3 模式總結與分析

- **Padding**：需防止 Padding Oracle 攻擊。
- **安全性考量**：模式選擇需根據應用需求平衡安全性與效率。

---

### 2.4 總結

本章針對 NIST SP 800-38 系列進行實作，以了解應用於訊息加密時所使用的加密模式。後續如需設計實際使用場景，尚需深入了解各個模式間目前已知的可能潛在安全議題，並針對 Padding 方法及初始化向量（IV）的生成方式進行更嚴謹的研究。

---

## 3. 總結

AES 是現代加密技術的基石，憑藉其高效能和靈活性成為對稱加密的標準選擇。本次專題實作不僅完成了 AES 的核心算法與模式研究，還為未來應用設計提供了參考基礎。未來研究方向包括量子抗性、硬體加速及進一步的混合加密應用。